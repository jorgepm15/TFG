{
  "timestamp": "2025-07-14T20:17:19.418700",
  "vulnerabilities": [],
  "summary": {
    "total_vulnerabilities": 3,
    "critical": 1,
    "high": 2,
    "apis_scanned": 3
  },
  "apis_tested": [
    {
      "name": "VulnBank",
      "url": "http://localhost:3001",
      "vulnerabilities": [
        {
          "type": "Race Condition",
          "api": "http://localhost:3001",
          "severity": "HIGH",
          "details": {
            "initial_balance": 1000,
            "final_balance": 600,
            "expected_balance": -1000,
            "successful_transfers": 5,
            "inconsistency": true,
            "concurrent_requests": 5,
            "timing_window": 0.16640806198120117
          },
          "evidence": [
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Transfer completed",
                "fromBalance": 600,
                "toBalance": 900,
                "timestamp": "2025-07-14T18:17:19.597Z"
              },
              "timing": 0.16441106796264648,
              "timestamp": 1752517039.434707
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Transfer completed",
                "fromBalance": 600,
                "toBalance": 900,
                "timestamp": "2025-07-14T18:17:19.598Z"
              },
              "timing": 0.1644437313079834,
              "timestamp": 1752517039.4353828
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Transfer completed",
                "fromBalance": 600,
                "toBalance": 900,
                "timestamp": "2025-07-14T18:17:19.599Z"
              },
              "timing": 0.1651160717010498,
              "timestamp": 1752517039.4360726
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Transfer completed",
                "fromBalance": 600,
                "toBalance": 900,
                "timestamp": "2025-07-14T18:17:19.600Z"
              },
              "timing": 0.1652843952178955,
              "timestamp": 1752517039.4371064
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Transfer completed",
                "fromBalance": 600,
                "toBalance": 900,
                "timestamp": "2025-07-14T18:17:19.601Z"
              },
              "timing": 0.16640806198120117,
              "timestamp": 1752517039.4368775
            }
          ],
          "found": true
        }
      ],
      "scan_time": "2025-07-14T20:17:19.418731",
      "info": {
        "name": "VulnBank API",
        "description": "Vulnerable banking API demonstrating race conditions",
        "vulnerabilities": [
          "Race Condition in transfers",
          "Non-atomic operations"
        ],
        "port": 3001
      }
    },
    {
      "name": "VulnAuth",
      "url": "http://localhost:3002",
      "vulnerabilities": [
        {
          "type": "Global State Pollution",
          "api": "http://localhost:3002",
          "severity": "CRITICAL",
          "found": true,
          "details": {
            "concurrent_logins": 2,
            "pollution_evidence": [
              "User admin got profile of user1"
            ],
            "state_confusion": true
          },
          "evidence": [
            {
              "username": "admin",
              "login_response": {
                "success": true,
                "user": {
                  "username": "admin",
                  "role": "admin",
                  "loginTime": "2025-07-14T18:17:19.629Z",
                  "requestId": "8e68670b-48d9-4494-9152-d23d79b9f0c3",
                  "extraPermissions": [
                    "manage_users",
                    "view_logs"
                  ]
                },
                "sessionId": "8e68670b-48d9-4494-9152-d23d79b9f0c3"
              },
              "profile_response": {
                "profile": {
                  "username": "user1",
                  "role": "user",
                  "loginTime": "2025-07-14T18:17:19.681Z",
                  "requestId": "5c8c30e6-42f3-49b6-8127-d07f59d89077"
                },
                "accessTime": "2025-07-14T18:17:19.745Z",
                "requestId": "26b6cb95-ed70-46a8-ad8a-f2fbf91e8674"
              },
              "timestamp": 1752517039.7466896
            },
            {
              "username": "user1",
              "login_response": {
                "success": true,
                "user": {
                  "username": "user1",
                  "role": "user",
                  "loginTime": "2025-07-14T18:17:19.681Z",
                  "requestId": "5c8c30e6-42f3-49b6-8127-d07f59d89077"
                },
                "sessionId": "5c8c30e6-42f3-49b6-8127-d07f59d89077"
              },
              "profile_response": {
                "profile": {
                  "username": "user1",
                  "role": "user",
                  "loginTime": "2025-07-14T18:17:19.681Z",
                  "requestId": "5c8c30e6-42f3-49b6-8127-d07f59d89077"
                },
                "accessTime": "2025-07-14T18:17:19.846Z",
                "requestId": "03e50559-71b7-4b91-b26f-c15dce9ff3a3"
              },
              "timestamp": 1752517039.8476772
            }
          ]
        }
      ],
      "scan_time": "2025-07-14T20:17:19.618318",
      "info": {
        "name": "VulnAuth API",
        "description": "Vulnerable authentication API demonstrating global state pollution",
        "vulnerabilities": [
          "Global state pollution",
          "Race conditions in auth"
        ],
        "port": 3002,
        "currentGlobalState": {
          "username": "user1",
          "role": "user",
          "loginTime": "2025-07-14T18:17:00.304Z",
          "requestId": "1494e4dd-bc6d-4701-9786-136225c030a1",
          "extraPermissions": [
            "manage_users",
            "view_logs"
          ]
        }
      }
    },
    {
      "name": "VulnShop",
      "url": "http://localhost:3003",
      "vulnerabilities": [
        {
          "type": "TOCTOU (Time-of-Check-Time-of-Use)",
          "api": "http://localhost:3003",
          "severity": "HIGH",
          "found": true,
          "details": {
            "initial_price": 100,
            "final_price": 32.768,
            "successful_applications": 5,
            "total_discounts_applied": 5,
            "single_use_coupon_bypassed": true,
            "price_reduction": 67.232
          },
          "evidence": [
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Coupon applied successfully",
                "discount": {
                  "discountAmount": 20,
                  "newPrice": 32.768,
                  "couponDiscount": 20
                },
                "requestId": "b22c75f0-630a-4674-8b36-8a9be8fdef3d",
                "timestamp": "2025-07-14T18:17:20.129Z"
              },
              "timestamp": 1752517040.1304972
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Coupon applied successfully",
                "discount": {
                  "discountAmount": 16,
                  "newPrice": 32.768,
                  "couponDiscount": 20
                },
                "requestId": "ae1e13ea-3544-44fe-b9fc-2146d6ce252e",
                "timestamp": "2025-07-14T18:17:20.129Z"
              },
              "timestamp": 1752517040.1312573
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Coupon applied successfully",
                "discount": {
                  "discountAmount": 12.8,
                  "newPrice": 32.768,
                  "couponDiscount": 20
                },
                "requestId": "de7664b8-b1fd-48ca-8bb8-dc51d4ebea32",
                "timestamp": "2025-07-14T18:17:20.130Z"
              },
              "timestamp": 1752517040.1320217
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Coupon applied successfully",
                "discount": {
                  "discountAmount": 10.24,
                  "newPrice": 32.768,
                  "couponDiscount": 20
                },
                "requestId": "39cf4b40-1544-4358-875a-b1e7b9f00b5a",
                "timestamp": "2025-07-14T18:17:20.131Z"
              },
              "timestamp": 1752517040.1328542
            },
            {
              "status_code": 200,
              "response": {
                "success": true,
                "message": "Coupon applied successfully",
                "discount": {
                  "discountAmount": 8.192,
                  "newPrice": 32.768,
                  "couponDiscount": 20
                },
                "requestId": "d0ad510b-28b9-48d4-9ed7-41019bedd902",
                "timestamp": "2025-07-14T18:17:20.132Z"
              },
              "timestamp": 1752517040.133538
            }
          ]
        }
      ],
      "scan_time": "2025-07-14T20:17:19.848253",
      "info": {
        "name": "VulnShop API",
        "description": "Vulnerable e-commerce API demonstrating TOCTOU vulnerabilities",
        "vulnerabilities": [
          "TOCTOU in coupon validation",
          "Race conditions in discount application"
        ],
        "port": 3003,
        "availableCoupons": [
          "SAVE20",
          "WELCOME10",
          "FLASH50"
        ],
        "availableOrders": [
          "order1",
          "order2",
          "order3"
        ]
      }
    }
  ]
}